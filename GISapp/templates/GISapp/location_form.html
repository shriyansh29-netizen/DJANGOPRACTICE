<!DOCTYPE html>
<html>
<head>
    <title>Submit Location</title>
</head>
<body>
  <h2>Submit Your Location</h2>
  
  <form id="locationForm" method="post">
    {% csrf_token %}
    <label for="name">Name:</label>
    <input type="text" name="name" id="name" required /><br/><br/>

    <input type="hidden" name="latitude" id="latitude" />
    <input type="hidden" name="longitude" id="longitude" />

    <button type="submit">Submit</button>
  </form>

<script>
document.getElementById('locationForm').addEventListener('submit', function(event) {
  // Prevent immediate form submit
  event.preventDefault();

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      document.getElementById('latitude').value = position.coords.latitude;
      document.getElementById('longitude').value = position.coords.longitude;
      event.target.submit();  // Now submit the form
    }, function(error) {
      alert('Error getting location: ' + error.message);
      // Optionally submit without location:
      // event.target.submit();
    });
  } else {
    alert('Geolocation not supported by your browser');
    // Optionally submit form without location:
    // event.target.submit();
  }
});
</script>

</body>
</html>
