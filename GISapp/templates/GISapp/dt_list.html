{% extends "GISapp/base.html" %}
{% block title %}DTs List{% endblock %}
{% block style %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center">DT Management</h2>

    <!-- Form to add DT -->
    <form method="POST" class="form-inline justify-content-center mb-3">
        {% csrf_token %}
        <input type="text" name="dt_name" class="form-control mr-2" placeholder="Enter DT Name" required>

        
        <select name="capacity" class="form-control mr-2" required>
            <option value="">Select Capacity</option>
            <option value="1000">1000</option>
            <option value="630">630</option>
            <option value="400">400</option>
            <option value="250">250</option>
            <option value="100">100</option>
            <option value="63">63</option>
            <option value="25">25</option>
            <option value="10">10</option>
        </select>
        
        <select name="feeder_id" class="form-control mr-2" required>
            <option value="">Select Feeder</option>
            {% for feeder in feeders %}
                <option value="{{ feeder.id }}">{{ feeder.name }}</option>
            {% endfor %}
        </select>
        
        <button type="submit" class="btn btn-primary">Add DT</button>
    </form>

    <!-- DTs list feeder-wise -->
    <div class="mt-4">
        {% for feeder in feeders %}
            <h4>{{ feeder.name }}</h4>
            <ul class="list-group mb-3">
                {% for dt in feeder.dts.all %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ dt.name }} - {{ dt.capacity }} kVA
                        <a href="{% url 'dt_delete' dt.id %}" class="btn btn-danger btn-sm">Delete</a>
                    </li>
                {% empty %}
                    <li class="list-group-item">No DTs for this feeder.</li>
                {% endfor %}
            </ul>
        {% endfor %}
    </div>
</div>
{% endblock %}
